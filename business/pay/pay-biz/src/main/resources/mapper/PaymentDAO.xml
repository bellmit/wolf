<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="study.daydayup.wolf.business.pay.biz.dal.dao.PaymentDAO">


<!--auto generated by MybatisCodeHelper on 2020-02-29-->
    <update id="updateByPaymentNo">
        update payment
        <set>
            <if test="updated.state != null">
                state = #{updated.state,jdbcType=TINYINT},
            </if>
            <if test="updated.outTradeNo != null and updated.outTradeNo != ''">
                out_trade_no = #{updated.outTradeNo,jdbcType=VARCHAR},
            </if>
            <if test="updated.tags != null and updated.tags != ''">
                tags = #{updated.tags,jdbcType=VARCHAR},
            </if>
            <if test="updated.attachment != null and updated.attachment != ''">
                attachment = #{updated.attachment,jdbcType=VARCHAR},
            </if>
            <if test="updated.version != null">
                version = #{updated.version,jdbcType=INTEGER},
            </if>
            <if test="updated.deleteFlag != null">
                delete_flag = #{updated.deleteFlag,jdbcType=TINYINT},
            </if>
            <if test="updated.lastEditor != null">
                last_editor = #{updated.lastEditor,jdbcType=BIGINT},
            </if>
            <if test="updated.updatedAt != null">
                updated_at = #{updated.updatedAt,jdbcType=TIMESTAMP},
            </if>
        </set>
        where payment_no=#{paymentNo,jdbcType=VARCHAR}
        limit 1
    </update>

<!--auto generated by MybatisCodeHelper on 2020-02-29-->
    <select id="selectByTradeNo" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from payment
        where trade_no=#{tradeNo,jdbcType=VARCHAR}
        and payee_id=#{payeeId,jdbcType=BIGINT}
        <if test="state != null" >
            and `state`=#{state,jdbcType=TINYINT}
        </if>
        order by id desc
    </select>

<!--auto generated by MybatisCodeHelper on 2020-02-29-->
    <select id="selectByPaymentNo" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from payment
        where payment_no=#{paymentNo,jdbcType=VARCHAR}
        limit 1
    </select>

<!--auto generated by MybatisCodeHelper on 2020-06-21-->
    <select id="selectByOutTradeNoAndPayeeId" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from payment
        where out_trade_no=#{outTradeNo,jdbcType=VARCHAR}
        and payee_id=#{payeeId,jdbcType=BIGINT}
        order by id desc
    </select>

<!--auto generated by MybatisCodeHelper on 2020-06-21-->
    <select id="selectByPayeeId" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from payment
        where payee_id=#{payeeId,jdbcType=BIGINT}
        <if test="state != null" >
            and `state`=#{state,jdbcType=TINYINT}
        </if>
        order by id desc
    </select>

<!--auto generated by MybatisCodeHelper on 2020-06-21-->
    <select id="selectByPaymentNoAndPayeeId" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from payment
        where payment_no=#{paymentNo,jdbcType=VARCHAR}
        and payee_id=#{payeeId,jdbcType=BIGINT}
        order by id desc
        limit 1
    </select>

<!--auto generated by MybatisCodeHelper on 2020-06-21-->
    <select id="selectByRange" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from payment
        where payee_id=#{query.payeeId,jdbcType=BIGINT}
        <if test="query.state != null">
            and state = #{query.state,jdbcType=TINYINT}
        </if>
        <if test="query.createdAfter != null">
            <![CDATA[ and created_at >= #{query.createdAfter,jdbcType=TIMESTAMP} ]]>
        </if>
        <if test="query.createdBefore != null">
            <![CDATA[ and created_at <= #{query.createdBefore,jdbcType=TIMESTAMP} ]]>
        </if>
        ORDER BY id desc
    </select>

<!--auto generated by MybatisCodeHelper on 2020-06-21-->
    <select id="selectByTradeNoAndPayeeId" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from payment
        where trade_no=#{tradeNo,jdbcType=VARCHAR}
        and payee_id=#{payeeId,jdbcType=BIGINT}
        ORDER BY id desc
    </select>
</mapper>