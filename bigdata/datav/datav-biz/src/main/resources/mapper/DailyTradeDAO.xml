<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="study.daydayup.wolf.bigdata.datav.biz.dal.dao.DailyTradeDAO">


    <!--auto generated by MybatisCodeHelper on 2020-03-26-->
    <select id="selectByDate" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from daily_trade
        where org_id = #{request.orgId, jdbcType=BIGINT}
        <if test="request.startDate != null">
            <![CDATA[ and `date` >= #{request.startDate,jdbcType=DATE} ]]>
        </if>
        <if test="request.endDate != null">
            <![CDATA[ and `date` <= #{request.endDate,jdbcType=DATE} ]]>
        </if>
        order by id desc
    </select>

<!--auto generated by MybatisCodeHelper on 2020-05-06-->
    <select id="selectByDateIn" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from daily_trade
        where `org_id` = #{request.orgId, jdbcType=BIGINT}
        and `date` in
        <foreach item="item" index="index" collection="request.dateList "
                 open="(" separator="," close=")">
            #{item,jdbcType=DATE}
        </foreach>
        <if test="request.tradeType != null">
            and `trade_type` = #{request.tradeType,jdbcType=INTEGER}
        </if>
        <if test="request.state != null">
            and `state` = #{request.state,jdbcType=INTEGER}
        </if>
        <if test="request.source != null">
            and `source` = #{request.source, jdbcType=VARCHAR}
        </if>
    </select>
</mapper>